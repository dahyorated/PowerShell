{"tasks":[{"environment":{},"displayName":"Get config Service secret from key vault","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"ConnectedServiceNameARM":"$(serviceConnection)","ScriptType":"FilePath","ScriptPath":"$(System.DefaultWorkingDirectory)/_IAC Scripts - CI/scripts/VSTSRMScripts/VSTSRMScripts/Get-ConfigServiceSecret.ps1","Inline":"# You can write your azure powershell scripts inline here. \n# You can also pass predefined and custom variables to this script using arguments","ScriptArguments":"-KeyVaultName $(keyvault) -ConfigAppService $(configUrl)","errorActionPreference":"stop","FailOnStandardError":"false","TargetAzurePs":"LatestVersion","CustomTargetAzurePs":"","pwsh":"false","workingDirectory":""},"task":{"id":"72a1931b-effb-4d2e-8fd8-f8472a07cb62","versionSpec":"4.*","definitionType":"task"}},{"environment":{},"displayName":"Get eureka service secret from key vault","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"ConnectedServiceNameARM":"$(serviceConnection)","ScriptType":"FilePath","ScriptPath":"$(System.DefaultWorkingDirectory)/_IAC Scripts - CI/scripts/VSTSRMScripts/VSTSRMScripts/Get-EurekaServiceSecret.ps1","Inline":"# You can write your azure powershell scripts inline here. \n# You can also pass predefined and custom variables to this script using arguments","ScriptArguments":"-KeyVaultName $(keyvault) -EurekaAppService $(appSvcName)","errorActionPreference":"stop","FailOnStandardError":"false","TargetAzurePs":"LatestVersion","CustomTargetAzurePs":"","pwsh":"false","workingDirectory":""},"task":{"id":"72a1931b-effb-4d2e-8fd8-f8472a07cb62","versionSpec":"4.*","definitionType":"task"}},{"environment":{},"displayName":"Stop Azure App Service: $(appSvcName)","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"ConnectedServiceName":"$(serviceConnection)","Action":"Stop Azure App Service","WebAppName":"$(appSvcName)","SpecifySlot":"false","ResourceGroupName":"","SourceSlot":"","SwapWithProduction":"true","TargetSlot":"","PreserveVnet":"false","Slot":"production","ExtensionsList":"","OutputVariable":"","AppInsightsResourceGroupName":"","ApplicationInsightsResourceName":"","ApplicationInsightsWebTestName":""},"task":{"id":"f045e430-8704-11e6-968f-e717e6411619","versionSpec":"0.*","definitionType":"task"}},{"environment":{},"displayName":"Deploy Azure App Service","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"ConnectionType":"AzureRM","ConnectedServiceName":"$(serviceConnection)","PublishProfilePath":"$(System.DefaultWorkingDirectory)/**/*.pubxml","PublishProfilePassword":"","WebAppKind":"webApp","WebAppName":"$(appSvcName)","DeployToSlotOrASEFlag":"false","ResourceGroupName":"","SlotName":"production","DockerNamespace":"","DockerRepository":"","DockerImageTag":"$(Build.BuildId)","VirtualApplication":"","Package":"$(packagePath)","RuntimeStack":"","RuntimeStackFunction":"","StartupCommand":"","ScriptType":"","InlineScript":"","ScriptPath":"","WebConfigParameters":"$(webConfigGeneration)","AppSettings":"$(appSettings) -configUrl $(configUrl) -config_spring_security_user_password $(config_spring_security_user_password) -eureka_spring_security_user_password $(eureka_spring_security_user_password)","ConfigurationSettings":"$(configurationSettings)","UseWebDeploy":"true","DeploymentType":"webDeploy","TakeAppOfflineFlag":"true","SetParametersFile":"","RemoveAdditionalFilesFlag":"true","ExcludeFilesFromAppDataFlag":"false","AdditionalArguments":"","RenameFilesFlag":"true","XmlTransformation":"false","XmlVariableSubstitution":"false","JSONFiles":""},"task":{"id":"497d490f-eea7-4f2b-ab94-48d9c1acdcb1","versionSpec":"4.*","definitionType":"task"}},{"environment":{},"displayName":"Start Azure App Service: $(appSvcName)","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"ConnectedServiceName":"$(serviceConnection)","Action":"Start Azure App Service","WebAppName":"$(appSvcName)","SpecifySlot":"false","ResourceGroupName":"","SourceSlot":"","SwapWithProduction":"true","TargetSlot":"","PreserveVnet":"false","Slot":"production","ExtensionsList":"","OutputVariable":"","AppInsightsResourceGroupName":"","ApplicationInsightsResourceName":"","ApplicationInsightsWebTestName":""},"task":{"id":"f045e430-8704-11e6-968f-e717e6411619","versionSpec":"0.*","definitionType":"task"}}],"runsOn":["Agent","DeploymentGroup"],"revision":22,"createdBy":{"displayName":"Tom Handler","id":"f832c526-d677-696e-ba34-0601ce39fd83","uniqueName":"Tom.Handler@ey.com"},"createdOn":"2019-12-17T17:35:13.213Z","modifiedBy":{"displayName":"Brad Friedlander","id":"23725266-5bf7-603d-b232-59edf9d07071","uniqueName":"Brad.Friedlander@ey.com"},"modifiedOn":"2020-03-03T10:40:22.640Z","comment":"","id":"f61b0774-d7c5-4225-a636-47e9be6b16e5","name":"Deploy Eureka Java App Service","version":{"major":1,"minor":0,"patch":0,"isTest":false},"iconUrl":"https://cdn.vsassets.io/v/M162_20191216.4/_content/icon-meta-task.png","friendlyName":"Deploy Eureka Java App Service","description":"","category":"Deploy","definitionType":"metaTask","author":"Tom Handler","demands":[],"groups":[],"inputs":[{"aliases":[],"options":{},"properties":{},"name":"appSettings","label":"appSettings","defaultValue":"-ASPNETCORE_ENVIRONMENT $(ASPNETCORE_ENVIRONMENT)","required":true,"type":"string","helpMarkDown":"","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"appSvcName","label":"appSvcName","defaultValue":"$(appSvcname)","required":true,"type":"string","helpMarkDown":"","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"config_spring_security_user_password","label":"config_spring_security_user_password","defaultValue":"$(config_spring_security_user_password)","required":true,"type":"string","helpMarkDown":"This is the password for the config service","groupName":""},{"aliases":[],"options":{},"properties":{"editorExtension":"ms.vss-services-azure.parameters-grid"},"name":"configurationSettings","label":"configurationSettings","defaultValue":"-javaVersion $(javaVersion) -javaContainer $(javaContainer) -javaContainerVersion $(javaContainerVersion)","required":true,"type":"multiLine","helpMarkDown":"Edit web app configuration settings following the syntax -key value. Value containing spaces should be enclosed in double quotes.<br /> Example : -phpVersion 5.6 -linuxFxVersion: node|6.11","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"configUrl","label":"configUrl","defaultValue":"$(configUrl)","required":true,"type":"string","helpMarkDown":"This is the URL for the config service","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"eureka_spring_security_user_password","label":"eureka_spring_security_user_password","defaultValue":"$(eureka_spring_security_user_password)","required":true,"type":"string","helpMarkDown":"This is the password for the eureka service","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"keyvault","label":"keyvault","defaultValue":"$(keyvault)","required":true,"type":"string","helpMarkDown":"This is the keyvault for the environment","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"packagePath","label":"packagePath","defaultValue":"$(System.DefaultWorkingDirectory)/**/*.zip","required":true,"type":"filePath","helpMarkDown":"File path to the package or a folder containing app service contents generated by MSBuild or a compressed zip or war file.<br />Variables ( [Build](https://docs.microsoft.com/vsts/pipelines/build/variables) | [Release](https://docs.microsoft.com/vsts/pipelines/release/variables#default-variables)), wildcards are supported. <br/> For example, $(System.DefaultWorkingDirectory)/\\*\\*/\\*.zip or $(System.DefaultWorkingDirectory)/\\*\\*/\\*.war.","groupName":""},{"aliases":[],"options":{},"properties":{"EndpointFilterRule":"ScopeLevel != AzureMLWorkspace"},"name":"serviceConnection","label":"serviceConnection","defaultValue":"$(serviceConnection)","required":true,"type":"connectedService:AzureRM","helpMarkDown":"Azure Resource Manager subscription to configure before running PowerShell","groupName":""},{"aliases":[],"options":{},"properties":{"editorExtension":"ms.vss-services-azure.webconfig-parameters-grid"},"name":"webConfigGeneration","label":"webConfigGeneration","defaultValue":"$(webConfigGeneration)","required":true,"type":"multiLine","helpMarkDown":"A standard Web.config will be generated and deployed to Azure App Service if the application does not have one. The values in web.config can be edited and vary based on the application framework. For example for node.js application, web.config will have startup file and iis_node module values. This edit feature is only for the generated web.config. [Learn more](https://go.microsoft.com/fwlink/?linkid=843469).","groupName":""}],"satisfies":[],"sourceDefinitions":[],"dataSourceBindings":[],"instanceNameFormat":"Task group: Deploy Eureka Java App Service $(appSettings)","preJobExecution":{},"execution":{},"postJobExecution":{}}