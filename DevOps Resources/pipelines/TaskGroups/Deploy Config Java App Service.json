{"tasks":[{"environment":{},"displayName":"Get configurationServiceSecret from key vault","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"ConnectedServiceNameARM":"$(serviceConnection)","ScriptType":"FilePath","ScriptPath":"$(System.DefaultWorkingDirectory)/_IAC Scripts - CI/scripts/VSTSRMScripts/VSTSRMScripts/Get-ConfigServiceSecret.ps1","Inline":"# You can write your azure powershell scripts inline here. \n# You can also pass predefined and custom variables to this script using arguments","ScriptArguments":"-KeyVaultName $(keyvault) -ConfigAppService $(appSvcName)","errorActionPreference":"stop","FailOnStandardError":"false","TargetAzurePs":"LatestVersion","CustomTargetAzurePs":"","pwsh":"false","workingDirectory":""},"task":{"id":"72a1931b-effb-4d2e-8fd8-f8472a07cb62","versionSpec":"4.*","definitionType":"task"}},{"environment":{},"displayName":"Stop Azure App Service: $(appSvcName)","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"ConnectedServiceName":"$(serviceConnection)","Action":"Stop Azure App Service","WebAppName":"$(appSvcName)","SpecifySlot":"false","ResourceGroupName":"","SourceSlot":"","SwapWithProduction":"true","TargetSlot":"","PreserveVnet":"false","Slot":"production","ExtensionsList":"","OutputVariable":"","AppInsightsResourceGroupName":"","ApplicationInsightsResourceName":"","ApplicationInsightsWebTestName":""},"task":{"id":"f045e430-8704-11e6-968f-e717e6411619","versionSpec":"0.*","definitionType":"task"}},{"environment":{},"displayName":"Deploy Jar to Azure App Service","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"ConnectionType":"AzureRM","ConnectedServiceName":"$(serviceConnection)","PublishProfilePath":"$(System.DefaultWorkingDirectory)/**/*.pubxml","PublishProfilePassword":"","WebAppKind":"webApp","WebAppName":"$(appSvcName)","DeployToSlotOrASEFlag":"false","ResourceGroupName":"","SlotName":"production","DockerNamespace":"","DockerRepository":"","DockerImageTag":"$(Build.BuildId)","VirtualApplication":"","Package":"$(System.DefaultWorkingDirectory)/_Configuration Service - CI/drop/**/*.jar","RuntimeStack":"","RuntimeStackFunction":"","StartupCommand":"","ScriptType":"","InlineScript":"","ScriptPath":"","WebConfigParameters":"-JAR_PATH D:\\home\\site\\wwwroot\\*.jar -ADDITIONAL_DEPLOYMENT_OPTIONS '-Dserver.port=$(serverPort)' -appType Java_SpringBoot","AppSettings":"-ASPNETCORE_ENVIRONMENT $(ASPNETCORE_ENVIRONMENT) -repo $(repo) -configSecret $(configSecret) -config_spring_security_user_password $(config_spring_security_user_password","ConfigurationSettings":"-javaVersion $(javaVersion) -javaContainer $(javaContainer) -javaContainerVersion $(javaContainerVersion)","UseWebDeploy":"false","DeploymentType":"webDeploy","TakeAppOfflineFlag":"true","SetParametersFile":"","RemoveAdditionalFilesFlag":"false","ExcludeFilesFromAppDataFlag":"false","AdditionalArguments":"","RenameFilesFlag":"true","XmlTransformation":"false","XmlVariableSubstitution":"false","JSONFiles":""},"task":{"id":"497d490f-eea7-4f2b-ab94-48d9c1acdcb1","versionSpec":"4.*","definitionType":"task"}},{"environment":{},"displayName":"Start Azure App Service: $(appSvcName)","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"ConnectedServiceName":"$(serviceConnection)","Action":"Start Azure App Service","WebAppName":"$(appSvcName)","SpecifySlot":"false","ResourceGroupName":"","SourceSlot":"","SwapWithProduction":"true","TargetSlot":"","PreserveVnet":"false","Slot":"production","ExtensionsList":"","OutputVariable":"","AppInsightsResourceGroupName":"","ApplicationInsightsResourceName":"","ApplicationInsightsWebTestName":""},"task":{"id":"f045e430-8704-11e6-968f-e717e6411619","versionSpec":"0.*","definitionType":"task"}}],"runsOn":["Agent","DeploymentGroup"],"revision":11,"createdBy":{"displayName":"Brad Friedlander","id":"23725266-5bf7-603d-b232-59edf9d07071","uniqueName":"Brad.Friedlander@ey.com"},"createdOn":"2020-01-03T17:19:23.203Z","modifiedBy":{"displayName":"Tom McFarland","id":"81dd8bdc-9750-68b4-940c-3fd42851912c","uniqueName":"Tom.McFarland@ey.com"},"modifiedOn":"2020-04-14T18:14:56.353Z","comment":"Added config_spring_security_user_password to app settings","id":"47c6caab-9ca5-42c5-bf0a-d4c2a5bbbe06","name":"Deploy Config Java App Service","version":{"major":1,"minor":0,"patch":0,"isTest":false},"iconUrl":"https://cdn.vsassets.io/v/M162_20191218.3/_content/icon-meta-task.png","friendlyName":"Deploy Config Java App Service","description":"","category":"Deploy","definitionType":"metaTask","author":"Brad Friedlander","demands":[],"groups":[],"inputs":[{"aliases":[],"options":{},"properties":{},"name":"appSvcName","label":"appSvcName","defaultValue":"$(appSvcName)","required":true,"type":"string","helpMarkDown":"","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"ASPNETCORE_ENVIRONMENT","label":"ASPNETCORE_ENVIRONMENT","defaultValue":"$(ASPNETCORE_ENVIRONMENT)","required":true,"type":"string","helpMarkDown":"","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"configSecret","label":"configSecret","defaultValue":"$(configSecret)","required":true,"type":"string","helpMarkDown":"","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"javaContainer","label":"javaContainer","defaultValue":"$(javaContainer)","required":true,"type":"string","helpMarkDown":"","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"javaContainerVersion","label":"javaContainerVersion","defaultValue":"$(javaContainerVersion)","required":true,"type":"string","helpMarkDown":"","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"javaVersion","label":"javaVersion","defaultValue":"$(javaVersion)","required":true,"type":"string","helpMarkDown":"","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"keyvault","label":"keyvault","defaultValue":"$(keyvault)","required":true,"type":"string","helpMarkDown":"","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"repo","label":"repo","defaultValue":"$(repo)","required":true,"type":"string","helpMarkDown":"","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"serverPort","label":"serverPort","defaultValue":"$(serverPort)","required":true,"type":"string","helpMarkDown":"","groupName":""},{"aliases":[],"options":{},"properties":{"EndpointFilterRule":"ScopeLevel != AzureMLWorkspace"},"name":"serviceConnection","label":"serviceConnection","defaultValue":"$(serviceConnection)","required":true,"type":"connectedService:AzureRM","helpMarkDown":"Azure Resource Manager subscription to configure before running PowerShell","groupName":""}],"satisfies":[],"sourceDefinitions":[],"dataSourceBindings":[],"instanceNameFormat":"Task group: Deploy Config Java App Service $(appSvcName)","preJobExecution":{},"execution":{},"postJobExecution":{}}