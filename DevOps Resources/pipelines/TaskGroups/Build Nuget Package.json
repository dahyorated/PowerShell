{"tasks":[{"environment":{},"displayName":"Task group: Build Versioning","alwaysRun":true,"continueOnError":true,"condition":"succeededOrFailed()","enabled":true,"timeoutInMinutes":0,"inputs":{"library.debug":""},"task":{"id":"19e979ba-6e06-49bb-9c3c-03ebdcb6812d","versionSpec":"3.*","definitionType":"metaTask"}},{"environment":{},"displayName":"Use .Net Core sdk 2.2.102","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"packageType":"sdk","useGlobalJson":"false","workingDirectory":"","version":"2.2.102","includePreviewVersions":"false","installationPath":"$(Agent.ToolsDirectory)/dotnet","performMultiLevelLookup":"false"},"task":{"id":"b0ce7256-7898-45d3-9cb5-176b752bfea6","versionSpec":"2.*","definitionType":"task"}},{"environment":{},"displayName":"Use .Net Core sdk $(sdkVersion)","alwaysRun":false,"continueOnError":false,"condition":"and(succeeded(), ne(variables['sdkVersion'], '2.2.102'))","enabled":true,"timeoutInMinutes":0,"inputs":{"packageType":"sdk","useGlobalJson":"false","workingDirectory":"","version":"$(sdkVersion)","includePreviewVersions":"false","installationPath":"$(Agent.ToolsDirectory)/dotnet","performMultiLevelLookup":"false"},"task":{"id":"b0ce7256-7898-45d3-9cb5-176b752bfea6","versionSpec":"2.*","definitionType":"task"}},{"environment":{},"displayName":"Use NuGet $(nugetVersion)","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"versionSpec":"$(nugetVersion)","checkLatest":"false"},"task":{"id":"2c65196a-54fd-4a02-9be8-d9d1837b7c5d","versionSpec":"0.*","definitionType":"task"}},{"environment":{},"displayName":"NuGet restore","alwaysRun":false,"continueOnError":true,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"command":"restore","solution":"$(solutionPath)","selectOrConfig":"config","feedRestore":"","includeNuGetOrg":"true","nugetConfigPath":"$(nugetPath)","externalEndpoints":"","noCache":"false","disableParallelProcessing":"true","packagesDirectory":"","verbosityRestore":"Detailed","searchPatternPush":"$(Build.ArtifactStagingDirectory)/**/*.nupkg;!$(Build.ArtifactStagingDirectory)/**/*.symbols.nupkg","nuGetFeedType":"internal","feedPublish":"","publishPackageMetadata":"true","allowPackageConflicts":"false","externalEndpoint":"","verbosityPush":"Detailed","searchPatternPack":"**/*.csproj","configurationToPack":"$(BuildConfiguration)","outputDir":"$(Build.ArtifactStagingDirectory)","versioningScheme":"off","includeReferencedProjects":"false","versionEnvVar":"","requestedMajorVersion":"1","requestedMinorVersion":"0","requestedPatchVersion":"0","packTimezone":"utc","includeSymbols":"false","toolPackage":"false","buildProperties":"","basePath":"","verbosityPack":"Detailed","arguments":""},"task":{"id":"333b11bd-d341-40d9-afcf-b32d5ce6f23b","versionSpec":"2.*","definitionType":"task"}},{"environment":{},"displayName":"Prepare analysis on SonarQube","alwaysRun":false,"continueOnError":true,"condition":"and(succeeded(), eq(variables['doSonar'], true))","enabled":true,"timeoutInMinutes":15,"inputs":{"SonarQube":"5b3489b6-5ec5-4a58-bea9-640fa6fdd364","scannerMode":"MSBuild","configMode":"file","configFile":"sonar-project.properties","cliProjectKey":"","projectKey":"$(projectKey)","cliProjectName":"","projectName":"$(projectKey)","cliProjectVersion":"1.0","projectVersion":"1.0","cliSources":".","extraProperties":"# Additional properties that will be passed to the scanner, \n# Put one key=value per line, example:\n# sonar.exclusions=**/*.bin"},"task":{"id":"15b84ca1-b62f-4a2a-a403-89b77a063157","versionSpec":"4.*","definitionType":"task"}},{"environment":{},"displayName":"Build","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"command":"build","publishWebProjects":"true","projects":"$(solutionPath)","custom":"","arguments":"--configuration $(BuildConfiguration) /property:Version=$(Build.BuildNumber) /property:AssemblyVersion=$(Build.BuildNumber)","restoreArguments":"","publishTestResults":"true","testRunTitle":"","zipAfterPublish":"true","modifyOutputPath":"true","selectOrConfig":"select","feedRestore":"","includeNuGetOrg":"true","nugetConfigPath":"","externalEndpoints":"","noCache":"false","packagesDirectory":"","verbosityRestore":"Detailed","searchPatternPush":"$(Build.ArtifactStagingDirectory)/*.nupkg","nuGetFeedType":"internal","feedPublish":"","publishPackageMetadata":"true","externalEndpoint":"","searchPatternPack":"**/*.csproj","configurationToPack":"$(BuildConfiguration)","outputDir":"$(Build.ArtifactStagingDirectory)","nobuild":"false","includesymbols":"false","includesource":"false","versioningScheme":"off","versionEnvVar":"","requestedMajorVersion":"1","requestedMinorVersion":"0","requestedPatchVersion":"0","buildProperties":"","verbosityPack":"Detailed","workingDirectory":""},"task":{"id":"5541a522-603c-47ad-91fc-a4b1d163081b","versionSpec":"2.*","definitionType":"task"}},{"environment":{},"displayName":"VsTest - testAssemblies 2.0","alwaysRun":false,"continueOnError":false,"condition":"and(succeeded(), startsWith(variables['sdkVersion'], '2.'))","enabled":true,"timeoutInMinutes":0,"inputs":{"testSelector":"testAssemblies","testAssemblyVer2":"**\\EY.GTP.*test*.dll\n!**\\*TestAdapter*.dll\n!**\\obj\\**\n!**\\blacklistedFIles\\test.dll\n!**\\testhost.dll\n!**\\*TestPlatform*.dll","testPlan":"","testSuite":"","testConfiguration":"","tcmTestRun":"$(test.RunId)","searchFolder":"$(System.DefaultWorkingDirectory)","resultsFolder":"$(Agent.TempDirectory)\\TestResults","testFiltercriteria":"","runOnlyImpactedTests":"False","runAllTestsAfterXBuilds":"50","uiTests":"false","vstestLocationMethod":"version","vsTestVersion":"latest","vstestLocation":"","runSettingsFile":"$(runSettingsFile)","overrideTestrunParameters":"","pathtoCustomTestAdapters":"","runInParallel":"False","runTestsInIsolation":"False","codeCoverageEnabled":"true","otherConsoleOptions":"/framework:\"NETCoreApp,Version=v2.0\"","distributionBatchType":"basedOnTestCases","batchingBasedOnAgentsOption":"autoBatchSize","customBatchSizeValue":"10","batchingBasedOnExecutionTimeOption":"autoBatchSize","customRunTimePerBatchValue":"60","dontDistribute":"False","testRunTitle":"","platform":"","configuration":"","publishRunAttachments":"true","failOnMinTestsNotRun":"False","minimumExpectedTests":"1","diagnosticsEnabled":"True","collectDumpOn":"onAbortOnly","rerunFailedTests":"False","rerunType":"basedOnTestFailurePercentage","rerunFailedThreshold":"30","rerunFailedTestCasesMaxLimit":"5","rerunMaxAttempts":"3"},"task":{"id":"ef087383-ee5e-42c7-9a53-ab56c98420f9","versionSpec":"2.*","definitionType":"task"}},{"environment":{},"displayName":"VsTest - testAssemblies 3.0","alwaysRun":false,"continueOnError":false,"condition":"and(succeeded(), startsWith(variables['sdkVersion'], '3.'))","enabled":true,"timeoutInMinutes":0,"inputs":{"testSelector":"testAssemblies","testAssemblyVer2":"**\\EY.GTP.*test*.dll\n!**\\*TestAdapter*.dll\n!**\\obj\\**\n!**\\blacklistedFIles\\test.dll\n!**\\testhost.dll\n!**\\*TestPlatform*.dll","testPlan":"","testSuite":"","testConfiguration":"","tcmTestRun":"$(test.RunId)","searchFolder":"$(System.DefaultWorkingDirectory)","resultsFolder":"$(Agent.TempDirectory)\\TestResults","testFiltercriteria":"","runOnlyImpactedTests":"False","runAllTestsAfterXBuilds":"50","uiTests":"false","vstestLocationMethod":"version","vsTestVersion":"latest","vstestLocation":"","runSettingsFile":"$(runSettingsFile)","overrideTestrunParameters":"","pathtoCustomTestAdapters":"","runInParallel":"False","runTestsInIsolation":"False","codeCoverageEnabled":"true","otherConsoleOptions":"/framework:\"NETCoreApp,Version=v3.0\"","distributionBatchType":"basedOnTestCases","batchingBasedOnAgentsOption":"autoBatchSize","customBatchSizeValue":"10","batchingBasedOnExecutionTimeOption":"autoBatchSize","customRunTimePerBatchValue":"60","dontDistribute":"False","testRunTitle":"","platform":"","configuration":"","publishRunAttachments":"true","failOnMinTestsNotRun":"False","minimumExpectedTests":"1","diagnosticsEnabled":"True","collectDumpOn":"onAbortOnly","rerunFailedTests":"False","rerunType":"basedOnTestFailurePercentage","rerunFailedThreshold":"30","rerunFailedTestCasesMaxLimit":"5","rerunMaxAttempts":"3"},"task":{"id":"ef087383-ee5e-42c7-9a53-ab56c98420f9","versionSpec":"2.*","definitionType":"task"}},{"environment":{},"displayName":"Run Code Analysis","alwaysRun":false,"continueOnError":true,"condition":"and(succeeded(), eq(variables['doSonar'], true), eq(variables['Build.SourceBranch'], 'refs/heads/develop'))","enabled":true,"timeoutInMinutes":15,"inputs":{},"task":{"id":"6d01813a-9589-4b15-8491-8164aeb38055","versionSpec":"4.*","definitionType":"task"}},{"environment":{},"displayName":"Publish Quality Gate Result","alwaysRun":false,"continueOnError":true,"condition":"and(succeeded(), eq(variables['doSonar'], true), eq(variables['Build.SourceBranch'], 'refs/heads/develop'))","enabled":true,"timeoutInMinutes":15,"inputs":{"pollingTimeoutSec":"300"},"task":{"id":"291ed61f-1ee4-45d3-b1b0-bf822d9095ef","versionSpec":"4.*","definitionType":"task"}},{"environment":{},"displayName":"WhiteSource ","alwaysRun":false,"continueOnError":false,"condition":"and(succeeded(), eq(variables['Build.SourceBranch'], 'refs/heads/develop'))","enabled":true,"timeoutInMinutes":0,"inputs":{"cwd":"$(Build.SourcesDirectory)","extensions":"$(extensionList)","exclude":"","checkPolicies":"SEND_ALERTS","productRule":"productName","productName":"Global Tax Platform","productToken":"","productVersion":"","requesterEmail":"","projectRule":"projectName","projectName":"$(whiteSourceProjectName)","projectVersion":"$(Build.BuildNumber)","projectToken":"","forceCheckAllDependencies":"false","forceUpdate":"false","failOnError":"true","WhiteSourceService":"75ca0b12-e1f6-498e-96a2-6b2bc87311e7","proxyUrl":"","proxyUsername":"","proxyPassword":"","connectionTimeoutField":"","connectionRetries":"1","connectionRetriesInterval":"3"},"task":{"id":"521d1e00-f5fb-4b73-a93b-a1fe88a9af90","versionSpec":"1.*","definitionType":"task"}},{"environment":{},"displayName":"count lines of code","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"workingFolder":"","clocCliDownloadUrl":"https://github.com/AlDanial/cloc/releases/download/1.80/cloc-1.80.exe","arguments":"$(solutionFolder) --exclude-dir=node_modules,obj,bin,.vs"},"task":{"id":"7b598338-cf0d-4c3f-acc2-4967b6202533","versionSpec":"1.*","definitionType":"task"}},{"environment":{},"displayName":"Publish","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"command":"publish","publishWebProjects":"false","projects":"$(publishPath)","custom":"","arguments":"--configuration $(BuildConfiguration) --output $(build.artifactstagingdirectory) /property:Version=$(Build.BuildNumber) /property:AssemblyVersion=$(Build.BuildNumber)","restoreArguments":"","publishTestResults":"true","testRunTitle":"","zipAfterPublish":"false","modifyOutputPath":"true","selectOrConfig":"select","feedRestore":"","includeNuGetOrg":"true","nugetConfigPath":"","externalEndpoints":"","noCache":"false","packagesDirectory":"","verbosityRestore":"Detailed","searchPatternPush":"$(Build.ArtifactStagingDirectory)/*.nupkg","nuGetFeedType":"internal","feedPublish":"","publishPackageMetadata":"true","externalEndpoint":"","searchPatternPack":"**/*.csproj","configurationToPack":"$(BuildConfiguration)","outputDir":"$(Build.ArtifactStagingDirectory)","nobuild":"false","includesymbols":"false","includesource":"false","versioningScheme":"off","versionEnvVar":"","requestedMajorVersion":"1","requestedMinorVersion":"0","requestedPatchVersion":"0","buildProperties":"","verbosityPack":"Detailed","workingDirectory":""},"task":{"id":"5541a522-603c-47ad-91fc-a4b1d163081b","versionSpec":"2.*","definitionType":"task"}},{"environment":{},"displayName":"Publish Scripts","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"PathtoPublish":"$(buildScriptsFolder)","ArtifactName":"scripts","ArtifactType":"Container","TargetPath":"\\\\my\\share\\$(Build.DefinitionName)\\$(Build.BuildNumber)","Parallel":"false","ParallelCount":"8","FileCopyOptions":""},"task":{"id":"2ff763a7-ce83-4e1f-bc89-0ae63477cebe","versionSpec":"1.*","definitionType":"task"}},{"environment":{},"displayName":"Publish All Scripts","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"PathtoPublish":"$(allScriptsFolder)","ArtifactName":"allScripts","ArtifactType":"Container","TargetPath":"\\\\my\\share\\$(Build.DefinitionName)\\$(Build.BuildNumber)","Parallel":"false","ParallelCount":"8","FileCopyOptions":""},"task":{"id":"2ff763a7-ce83-4e1f-bc89-0ae63477cebe","versionSpec":"1.*","definitionType":"task"}},{"environment":{},"displayName":"Publish Artifact","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"PathtoPublish":"$(build.artifactstagingdirectory)","ArtifactName":"drop","ArtifactType":"Container","TargetPath":"\\\\my\\share\\$(Build.DefinitionName)\\$(Build.BuildNumber)","Parallel":"false","ParallelCount":"8","FileCopyOptions":""},"task":{"id":"2ff763a7-ce83-4e1f-bc89-0ae63477cebe","versionSpec":"1.*","definitionType":"task"}},{"environment":{},"displayName":"Check build quality","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"inputs":{"checkWarnings":"false","warningFailOption":"build","warningThreshold":"0","forceFewerWarnings":"false","allowWarningVariance":"false","warningVariance":"","warningFilters":"","inclusiveFiltering":"false","showStatistics":"false","warningTaskFilters":"/^(((android|xcode|gradlew)\\s+)?build|ant|maven|cmake|gulp)/i","checkCoverage":"true","coverageFailOption":"build","coverageType":"blocks","customCoverageType":"","coverageThreshold":"60","forceCoverageImprovement":"false","coverageUpperThreshold":"80","ignoreDecreaseAboveUpperThreshold":"true","useUncoveredElements":"false","allowCoverageVariance":"true","coverageVariance":"$(variance)","coverageDeltaType":"percentage","coveragePrecision":"4","buildConfiguration":"","buildPlatform":"","explicitFilter":"false","includePartiallySucceeded":"true","baseDefinitionFilter":"*","baseDefinitionId":"","baseRepoId":"","baseBranchRef":"","runTitle":"","disableCertCheck":"false","createBuildIssues":"true"},"task":{"id":"16a2ad20-f191-11e5-bed4-ab22bcd17937","versionSpec":"6.*","definitionType":"task"}}],"runsOn":["Agent"],"revision":91,"createdBy":{"displayName":"Brad Friedlander","id":"23725266-5bf7-603d-b232-59edf9d07071","uniqueName":"Brad.Friedlander@ey.com"},"createdOn":"2020-04-22T11:09:24.060Z","modifiedBy":{"displayName":"Brad Friedlander","id":"23725266-5bf7-603d-b232-59edf9d07071","uniqueName":"Brad.Friedlander@ey.com"},"modifiedOn":"2020-04-24T16:34:50.180Z","comment":"Published preview : Peer reviewed by Dan.","id":"95f811a1-b185-40b8-8865-31691718482c","name":"Build Microservice - Nuget","version":{"major":6,"minor":0,"patch":0,"isTest":false},"iconUrl":"https://cdn.vsassets.io/v/20180823T122705/_content/icon-meta-task.png","friendlyName":"Build Microservice - Nuget","description":"","category":"Build","definitionType":"metaTask","author":"Eric Means","demands":[],"groups":[],"inputs":[{"aliases":[],"options":{},"properties":{},"name":"allScriptsFolder","label":"allScriptsFolder","defaultValue":"src/EY/GTP/IAC","required":true,"type":"filePath","helpMarkDown":"The folder or file path to publish. This can be a fully-qualified path or a path relative to the root of the repository. Wildcards are not supported. [Variables](https://go.microsoft.com/fwlink/?LinkID=550988) are supported. Example: $(Build.ArtifactStagingDirectory)","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"BuildConfiguration","label":"BuildConfiguration","defaultValue":"release","required":true,"type":"string","helpMarkDown":"","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"buildScriptsFolder","label":"buildScriptsFolder","defaultValue":"src/EY/GTP/IAC/BuildScripts","required":true,"type":"filePath","helpMarkDown":"The folder or file path to publish. This can be a fully-qualified path or a path relative to the root of the repository. Wildcards are not supported. [Variables](https://go.microsoft.com/fwlink/?LinkID=550988) are supported. Example: $(Build.ArtifactStagingDirectory)","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"extensionList","label":"extensionList","defaultValue":".dll .nupkg","required":true,"type":"string","helpMarkDown":"List of extensions separated by space for WhiteSource","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"nugetPath","label":"nugetPath","defaultValue":"src/EY/GTP/nuget.config","required":true,"type":"filePath","helpMarkDown":"The NuGet.config in your repository that specifies the feeds from which to restore packages.","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"nugetVersion","label":"nugetVersion","defaultValue":"5.4.0","required":true,"type":"string","helpMarkDown":"A version or version range that specifies the NuGet version to make available on the path. Use x as a wildcard. See the [list of available NuGet versions](http://dist.nuget.org/tools.json).\n\nIf you want to match a pre-release version, the specification must contain a major, minor, patch, and pre-release version from the list above.\n\nExamples: 4.x, 3.3.x, 2.8.6, >=4.0.0-0","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"projectKey","label":"projectKey","defaultValue":"$(projectKey)","required":true,"type":"string","helpMarkDown":"The SonarQube project unique key, i.e. `sonar.projectKey`","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"publishPath","label":"publishPath","defaultValue":"","required":true,"type":"multiLine","helpMarkDown":"The path to the csproj file(s) to use. You can use wildcards (e.g. **/*.csproj for all .csproj files in all subfolders).","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"runSettingsFile","label":"runSettingsFile","defaultValue":"src/ey/gtp/runsettings.runsettings","required":true,"type":"filePath","helpMarkDown":"Path to runsettings or testsettings file to use with the tests.","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"sdkVersion","label":"sdkVersion","defaultValue":"2.2.102","required":true,"type":"string","helpMarkDown":"Specify exact version of .NET Core SDK or runtime to install.<br/>Find the value of `version-sdk` for installing SDK, or `version-runtime` for installing Runtime from any releases [here](https://github.com/microsoft/azure-pipelines-tasks/blob/master/Tasks/DotNetCoreInstallerV0/externals/releases.json).\n **NOTE: the task will not work with new versions of .NET Core. Kindly upgrade to 2.\\* version of the task to download latest versions od .NET Core.**","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"solutionFolder","label":"solutionFolder","defaultValue":"","required":true,"type":"string","helpMarkDown":"","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"solutionPath","label":"solutionPath","defaultValue":"**/*.sln","required":true,"type":"string","helpMarkDown":"","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"variance","label":"variance","defaultValue":"1","required":true,"type":"string","helpMarkDown":"Specify the maximum temporary decrease of code coverage that will not fail the build. You should set this value as low as possible. [[Docs]](https://github.com/MicrosoftPremier/VstsExtensions/blob/master/BuildQualityChecks/en-US/CodeCoveragePolicy.md#coverageVariance)","groupName":""},{"aliases":[],"options":{},"properties":{},"name":"whiteSourceProjectName","label":"whiteSourceProjectName","defaultValue":"$(Build.DefinitionName)","required":true,"type":"string","helpMarkDown":"A name that uniquely identifies the project to create or update. If you are creating a new project, then enter a unique name for the new project. If you are updating an existing project, then provide its name, which can be found on the WhiteSource GUI (on the GUI, select 'Projects' from the main navigation menu, and then select 'View All' to view all your existing projects).","groupName":""}],"satisfies":[],"sourceDefinitions":[],"dataSourceBindings":[],"instanceNameFormat":"Task group: Build Microservice - Nuget $(allScriptsFolder)","preJobExecution":{},"execution":{},"postJobExecution":{}}